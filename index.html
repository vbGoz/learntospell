<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Master your spelling skills with 221 spelling bee words, 3 game modes, and high-quality audio">
    <meta name="theme-color" content="#9333ea">
    <title>Word Club - Spelling Practice</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="./manifest.json">

    <!-- iOS PWA Support -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Word Club">
    <link rel="apple-touch-icon" href="./icon-192.png">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="./icon-192.png">

    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="module">
        import React, { useState, useEffect, useRef } from 'https://cdn.skypack.dev/react@18.2.0';
        import ReactDOM from 'https://cdn.skypack.dev/react-dom@18.2.0';
        
        const WORDS = `substantially
formidable
marquee
compunction
hyperventilated
onslaught
misanthrope
cravenly
hypocritical
traumatic
solemnly
contentious
ensemble
lye
lacrosse
cajolery
residuals
peroxide
apocalypse
barricade
anonymously
barrette
junket
Erie
silhouette
thesaurus
chandelier
concierge
hibiscus
maracas
burpees
piccolo
tulle
camphor
paparazzi
pogrom
pÃ¢tisserie
sarsaparilla
cannelloni
bronchitis
diphtheria
corbels
Kilimanjaro
protÃ©gÃ©
maquisards
Charolais
chair
brass
ready
hangdog
padlock
scatter
gobble
eel
sizzle
Spanish
hornet
oval
plastic
mason
slander
evergreen
decompose
reasons
dismantle
glance
oath
sneakers
duets
cursive
pastel
hype
nestled
mustiness
shrouded
moderate
mouthpiece
lantern
author
wily
veil
redress
cruiser
vitally
burrowed
pentagon
diagram
scrimmage
vulgar
resign
corrupt
potency
quartz
tournament
agribusiness
clementine
signature
influence
snorkeling
citadel
achievements
appliances
invective
badminton
gardenia
emphatically
absorption
prognosticate
Pacific
affiliation
synopsis
coriander
purgatory
torpor
covetous
oppression
abysmal
precipice
purview
suburbia
construe
fettle
curriculum
deuce
berth
cyst
knavery
synonym
purloined
delectation
austerity
nascent
extremophile
monolithic
coven
satisfice
nuptials
aquacade
assuage
ballistics
efficacy
dreidel
alacrity
elision
sanctimonious
heptathlon
tempera
mitosis
apologia
mesomorph
claustrophobia
glissade
antebellum
weir
sortie
compaÃ±ero
pelota
eloge
mansard
ramate
paranephric
tontine
asyllabia
velodrome
dysplasia
Columbiad
terricolous
soporiferous
cyclopean
messianic
Austronesia
maxillary
Euclidean
archizoic
aphagia
persillade
capriccio
chitin
maisonette
maunaloa
hexastich
bathypelagic
syzygy
pharisaical
vicegerent
pince-nez
carotid
salaam
forzato
covey
apartheid
kibbutz
putti
beignet
fricassee
abecedarius
collunarium
scamillus
buccinator
Tijuana
silenus
marcottage
schuss
bodegon
cri de coeur
chaise longue
tathagata
phalanstery
diapir
harmattan
farinha
shamiana
chautauqua
heishi
mostaccioli
baetyl
gardai
gelinotte
zamacueca
gelÃ¤ndesprung
sittringee`.split('\n').map(w => w.trim()).filter(w => w);

        // Kid-friendly definitions for all words
        const DEFINITIONS = {"substantially":"In a large or important amount.","formidable":"Very impressive and somewhat frightening because of size or power.","marquee":"A large sign above the entrance to a theater or hotel.","compunction":"A feeling of guilt or uneasiness about doing something wrong.","hyperventilated":"Breathed too quickly, often from panic or excitement.","onslaught":"A fierce or violent attack.","misanthrope":"A person who dislikes and avoids other people.","cravenly":"In a cowardly way, without courage.","hypocritical":"Pretending to have beliefs or virtues you don't really have.","traumatic":"Very upsetting or disturbing, causing emotional shock.","solemnly":"In a serious and formal manner.","contentious":"Causing or likely to cause disagreement or argument.","ensemble":"A group of musicians, actors, or dancers who perform together.","lye":"A strong chemical used for cleaning or making soap.","lacrosse":"A team sport played with a stick with a net on the end.","cajolery":"The act of persuading someone using flattery or gentle coaxing.","residuals":"Payments made to actors or creators for reruns of their work.","peroxide":"A chemical compound often used to bleach hair or clean wounds.","apocalypse":"A catastrophic event that brings about the end of the world.","barricade":"A barrier built to block a road or entrance.","anonymously":"Done without giving your name.","barrette":"A clip or clasp used to hold hair in place.","junket":"A trip taken by officials at public expense, or a sweet dessert.","Erie":"One of the five Great Lakes in North America.","silhouette":"The dark outline of something seen against a lighter background.","thesaurus":"A book that lists words with similar meanings.","chandelier":"A fancy light fixture that hangs from the ceiling with many bulbs.","concierge":"A hotel employee who helps guests with information and services.","hibiscus":"A tropical plant with large, colorful flowers.","maracas":"Musical instruments that make a rattling sound when shaken.","burpees":"An exercise where you squat, jump back, do a push-up, and jump up.","piccolo":"A small flute that makes high-pitched sounds.","tulle":"A soft, fine fabric often used for ballet tutus and veils.","camphor":"A strong-smelling substance used in medicines and moth balls.","paparazzi":"Photographers who follow famous people to take their pictures.","pogrom":"An organized attack on a particular group of people.","pÃ¢tisserie":"A French bakery that specializes in pastries and cakes.","sarsaparilla":"A sweet soft drink flavored with the root of a tropical plant.","cannelloni":"Large tube-shaped pasta usually stuffed with meat or cheese.","bronchitis":"An illness that causes swelling in the breathing tubes of the lungs.","diphtheria":"A serious disease that affects breathing and the throat.","corbels":"Stone or wood supports that stick out from walls to hold up structures.","Kilimanjaro":"The tallest mountain in Africa.","protÃ©gÃ©":"A person guided and supported by an older, more experienced person.","maquisards":"French resistance fighters during World War II.","Charolais":"A breed of large white cattle originally from France.","chair":"A piece of furniture with a seat and back for one person.","brass":"A shiny yellow metal made from copper and zinc.","ready":"Prepared and able to do something.","hangdog":"Looking sad, guilty, or ashamed.","padlock":"A detachable lock with a curved bar that snaps into place.","scatter":"To throw or spread things in different directions.","gobble":"To eat quickly and noisily.","eel":"A long, snake-like fish that lives in water.","sizzle":"To make a hissing sound like food cooking in hot oil.","Spanish":"The language spoken in Spain and many Latin American countries.","hornet":"A large wasp that can sting multiple times.","oval":"A shape like a stretched-out circle or egg.","plastic":"A synthetic material that can be molded into many shapes.","mason":"A person who builds with stone or brick.","slander":"False spoken statements that damage someone's reputation.","evergreen":"A tree or plant that keeps its green leaves all year.","decompose":"To break down and rot into simpler parts.","reasons":"Explanations or causes for why something happened.","dismantle":"To take something apart piece by piece.","glance":"A quick look at something.","oath":"A serious promise, often made by placing your hand on a Bible.","sneakers":"Casual athletic shoes with rubber soles.","duets":"Musical pieces performed by two people.","cursive":"A style of handwriting where letters are connected.","pastel":"A soft, pale color or a type of crayon used for drawing.","hype":"Extravagant publicity or exaggerated excitement about something.","nestled":"Settled comfortably or snugly in a protected spot.","mustiness":"A stale, moldy smell often found in old, damp places.","shrouded":"Covered or hidden from view.","moderate":"Average in amount, intensity, or quality; not extreme.","mouthpiece":"The part of a device you put in your mouth, or a spokesperson.","lantern":"A portable light with a protective case around it.","author":"A person who writes books, stories, or articles.","wily":"Clever in a sneaky or cunning way.","veil":"A thin piece of fabric worn to cover the face or head.","redress":"To correct or make up for a wrong that was done.","cruiser":"A type of ship or a police car.","vitally":"In an extremely important or essential way.","burrowed":"Dug a hole or tunnel underground.","pentagon":"A shape with five sides and five angles.","diagram":"A simple drawing that shows how something works or is organized.","scrimmage":"A practice game in sports like football or soccer.","vulgar":"Rude, crude, or lacking good taste.","resign":"To voluntarily leave a job or position.","corrupt":"Dishonest and willing to use power for personal gain.","potency":"The power or strength of something.","quartz":"A hard, shiny mineral often found in rocks.","tournament":"A competition with many players or teams competing for a prize.","agribusiness":"Large-scale farming operated as a business.","clementine":"A small, sweet type of orange that's easy to peel.","signature":"A person's name written in their own handwriting.","influence":"The power to affect or change someone or something.","snorkeling":"Swimming underwater while breathing through a tube.","citadel":"A fortress that protects a city.","achievements":"Things accomplished successfully through effort or skill.","appliances":"Devices or machines designed to do household tasks.","invective":"Insulting or abusive language.","badminton":"A game played with rackets and a shuttlecock over a net.","gardenia":"A plant with fragrant white or yellow flowers.","emphatically":"In a forceful, clear way that shows strong feeling.","absorption":"The process of taking something in or soaking it up.","prognosticate":"To predict what will happen in the future.","Pacific":"The largest ocean on Earth, between Asia and the Americas.","affiliation":"A connection or association with a group or organization.","synopsis":"A brief summary of a story or event.","coriander":"An herb with a fresh, citrusy flavor used in cooking.","purgatory":"A place or state of temporary punishment or suffering.","torpor":"A state of being inactive or sluggish.","covetous":"Having a strong desire for something that belongs to someone else.","oppression":"Cruel or unfair treatment by those in power.","abysmal":"Extremely bad or terrible.","precipice":"A very steep cliff or dangerous situation.","purview":"The range or scope of something's authority or concern.","suburbia":"The residential areas on the outskirts of a city.","construe":"To interpret or understand something in a particular way.","fettle":"A person's state of health or spirits.","curriculum":"The subjects and content taught in a school or course.","deuce":"A tie score in tennis, or the number two on dice or cards.","berth":"A sleeping place on a ship or train, or a ship's parking spot.","cyst":"A sac filled with fluid that forms in the body.","knavery":"Dishonest or crafty behavior.","synonym":"A word that means the same or nearly the same as another word.","purloined":"Stolen, especially in a sneaky way.","delectation":"Great pleasure or delight.","austerity":"Living in a simple way without luxury or excess.","nascent":"Just beginning to exist or develop.","extremophile":"An organism that lives in extremely harsh conditions.","monolithic":"Large, powerful, and difficult to change.","coven":"A group or gathering of witches.","satisfice":"To accept something that's good enough rather than perfect.","nuptials":"A wedding ceremony.","aquacade":"An elaborate water show with swimming and diving performances.","assuage":"To make an unpleasant feeling less intense.","ballistics":"The science of how projectiles move through the air.","efficacy":"The ability to produce the desired result.","dreidel":"A four-sided spinning top used in a Jewish game.","alacrity":"Quick and cheerful readiness.","elision":"The omission of a sound or syllable when speaking.","sanctimonious":"Acting morally superior to others in an annoying way.","heptathlon":"An athletic contest with seven different track and field events.","tempera":"A type of paint made by mixing colored powders with egg yolk.","mitosis":"The process where a cell divides into two identical cells.","apologia":"A formal written defense of one's opinions or conduct.","mesomorph":"A person with a muscular, athletic body type.","claustrophobia":"An extreme fear of being in small, enclosed spaces.","glissade":"A way of sliding down a snowy slope in a controlled manner.","antebellum":"Existing before a war, especially before the American Civil War.","weir":"A low dam built across a river to control water flow.","sortie":"A mission flown by a military aircraft, or a quick trip out.","compaÃ±ero":"A companion or friend, in Spanish.","pelota":"A ball game played in Spain and Latin America.","eloge":"A funeral oration or speech praising someone.","mansard":"A type of roof with two slopes on each side.","ramate":"Having branches.","paranephric":"Located near or around the kidney.","tontine":"An investment plan where the last survivor gets all the money.","asyllabia":"The inability to form syllables or words.","velodrome":"A stadium with a banked oval track for bicycle racing.","dysplasia":"Abnormal growth or development of cells or organs.","Columbiad":"A large cannon used during the American Civil War.","terricolous":"Living on or in the ground.","soporiferous":"Causing sleep or drowsiness.","cyclopean":"Gigantic or massive, like something built by mythical giants.","messianic":"Related to a savior or liberator.","Austronesia":"A region of islands in the Pacific and Indian Oceans.","maxillary":"Related to the upper jaw.","Euclidean":"Related to the geometry studied by the ancient Greek mathematician Euclid.","archizoic":"Related to the earliest forms of life on Earth.","aphagia":"The inability to swallow.","persillade":"A French sauce made with parsley and garlic.","capriccio":"A lively piece of music in a free, spontaneous style.","chitin":"A tough substance that forms the outer covering of insects.","maisonette":"A small house or an apartment on two floors.","maunaloa":"One of the world's largest active volcanoes, located in Hawaii.","hexastich":"A poem or stanza with six lines.","bathypelagic":"Relating to the deep ocean zone where no light reaches.","syzygy":"An alignment of three celestial bodies, like the sun, moon, and Earth.","pharisaical":"Acting self-righteous or hypocritically pious.","vicegerent":"A person acting as a deputy or representative of a ruler.","pince-nez":"Eyeglasses that clip onto the nose without earpieces.","carotid":"Related to the major arteries in the neck that supply blood to the head.","salaam":"A greeting of peace used in Arabic and Muslim cultures.","forzato":"A musical term meaning to play a note with sudden emphasis.","covey":"A small group or flock, especially of birds like quail.","apartheid":"A system of racial segregation that existed in South Africa.","kibbutz":"A communal farm or settlement in Israel.","putti":"Chubby cherubs or baby angels often seen in art.","beignet":"A square French doughnut covered in powdered sugar.","fricassee":"A dish of meat cut into pieces and cooked in a thick sauce.","abecedarius":"A poem where each line starts with successive letters of the alphabet.","collunarium":"A place where offerings to the gods are stored.","scamillus":"A small platform or pedestal in classical architecture.","buccinator":"The cheek muscle used for blowing and chewing.","Tijuana":"A city in Mexico near the U.S. border.","silenus":"A companion of the wine god Dionysus in Greek mythology.","marcottage":"A method of plant reproduction by layering branches.","schuss":"A straight, fast run down a ski slope.","bodegon":"A Spanish still-life painting, often showing food.","cri de coeur":"A passionate outcry or appeal from the heart.","chaise longue":"A long chair for reclining, with a backrest at one end.","tathagata":"A title for Buddha meaning 'one who has arrived at truth.'","phalanstery":"A communal living building proposed by utopian thinkers.","diapir":"A dome-shaped rock formation created by upward pressure.","harmattan":"A dry, dusty wind that blows from the Sahara Desert.","farinha":"A flour or meal made from cassava root, popular in Brazil.","shamiana":"A large tent or canopy used for outdoor events in India.","chautauqua":"An educational assembly popular in rural America in the 1800s.","heishi":"Small shell beads used in Native American jewelry.","mostaccioli":"Tube-shaped pasta with ridges, similar to penne.","baetyl":"A sacred stone believed to house a deity.","gardai":"Police officers in Ireland.","gelinotte":"A type of game bird, also called a hazel grouse.","zamacueca":"A South American dance with Spanish and African influences.","gelÃ¤ndesprung":"A skiing maneuver where you jump and turn while airborne.","sittringee":"Striped cotton fabric from India."};

        // Simple inline SVG icons
        const Volume2 = ({ size = 24 }) => React.createElement('svg', { width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
            React.createElement('polygon', { points: '11 5 6 9 2 9 2 15 6 15 11 19 11 5' }),
            React.createElement('path', { d: 'M15.54 8.46a5 5 0 0 1 0 7.07' }),
            React.createElement('path', { d: 'M19.07 4.93a10 10 0 0 1 0 14.14' })
        );

        const Check = ({ size = 24 }) => React.createElement('svg', { width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
            React.createElement('polyline', { points: '20 6 9 17 4 12' })
        );

        const X = ({ size = 24 }) => React.createElement('svg', { width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
            React.createElement('line', { x1: 18, y1: 6, x2: 6, y2: 18 }),
            React.createElement('line', { x1: 6, y1: 6, x2: 18, y2: 18 })
        );

        const Home = ({ size = 24 }) => React.createElement('svg', { width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
            React.createElement('path', { d: 'm3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z' }),
            React.createElement('polyline', { points: '9 22 9 12 15 12 15 22' })
        );

        // localStorage utilities
        const STORAGE_KEY = 'wordClubData';

        const getDefaultUserData = () => ({
            settings: {
                difficulty: 'all'
            },
            stats: {
                totalWordsAttempted: 0,
                totalCorrect: 0,
                bestStreak: 0,
                sessionCount: 1,
                lastPlayed: new Date().toISOString()
            },
            wordHistory: {}, // { wordName: { attempts: 0, correct: 0, lastAttempt: timestamp } }
            achievements: []
        });

        const loadUserData = () => {
            try {
                const saved = localStorage.getItem(STORAGE_KEY);
                if (saved) {
                    const data = JSON.parse(saved);
                    // Merge with defaults to handle new properties
                    return { ...getDefaultUserData(), ...data };
                }
            } catch (error) {
                console.error('Failed to load user data:', error);
            }
            return getDefaultUserData();
        };

        const saveUserData = (userData) => {
            try {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(userData));
            } catch (error) {
                console.error('Failed to save user data:', error);
            }
        };

        const updateWordHistory = (userData, word, isCorrect) => {
            const wordHistory = { ...userData.wordHistory };
            if (!wordHistory[word]) {
                wordHistory[word] = { attempts: 0, correct: 0, lastAttempt: null };
            }
            wordHistory[word].attempts += 1;
            if (isCorrect) {
                wordHistory[word].correct += 1;
            }
            wordHistory[word].lastAttempt = new Date().toISOString();
            return wordHistory;
        };

        const getMissedWords = (userData, allWords) => {
            return allWords.filter(word => {
                const history = userData.wordHistory[word];
                if (!history || history.attempts === 0) return false; // Not attempted yet
                const accuracy = history.correct / history.attempts;
                return accuracy < 0.5; // Less than 50% accuracy
            });
        };

        const getMasteryStats = (userData, allWords) => {
            let mastered = 0;
            let practiced = 0;
            let needsPractice = 0;

            allWords.forEach(word => {
                const history = userData.wordHistory[word];
                if (!history || history.attempts === 0) return;

                practiced++;
                const accuracy = history.correct / history.attempts;

                if (accuracy >= 0.8 && history.correct >= 3) {
                    mastered++; // 80%+ accuracy and at least 3 correct
                } else if (accuracy < 0.5) {
                    needsPractice++;
                }
            });

            return {
                mastered,
                practiced,
                needsPractice,
                notPracticed: allWords.length - practiced
            };
        };

        function SpellingApp() {
            const [mode, setMode] = useState('home');
            const [currentWordIndex, setCurrentWordIndex] = useState(0);
            const [userInput, setUserInput] = useState('');
            const [feedback, setFeedback] = useState(null);
            const [score, setScore] = useState(0);
            const [streak, setStreak] = useState(0);
            const [wordsAttempted, setWordsAttempted] = useState(0);
            const [shuffledWords, setShuffledWords] = useState([]);
            const [scrambledLetters, setScrambledLetters] = useState([]);
            const [selectedLetters, setSelectedLetters] = useState([]);
            const [multipleChoiceOptions, setMultipleChoiceOptions] = useState([]);
            const [difficultyFilter, setDifficultyFilter] = useState('all');
            const [userData, setUserData] = useState(loadUserData());
            const inputRef = useRef(null);
            const audioRef = useRef(null); // Track current audio

            // Load saved difficulty preference on mount
            useEffect(() => {
                const loaded = loadUserData();
                setDifficultyFilter(loaded.settings.difficulty);
            }, []);

            useEffect(() => {
                const filtered = filterWordsByDifficulty(WORDS, difficultyFilter);
                const shuffled = [...filtered].sort(() => Math.random() - 0.5);
                setShuffledWords(shuffled);
                setCurrentWordIndex(0);
            }, [mode, difficultyFilter]);

            useEffect(() => {
                if (feedback !== null) return; // Don't play audio when showing feedback
                if (shuffledWords.length === 0) return; // Don't play if no words loaded

                let timer;

                if (mode === 'unscramble') {
                    const word = shuffledWords[currentWordIndex];
                    const letters = word.split('').sort(() => Math.random() - 0.5);
                    setScrambledLetters(letters.map((l, i) => ({ letter: l, id: i })));
                    timer = setTimeout(() => speakWord(word), 500);
                } else if (mode === 'multiple-choice') {
                    const word = shuffledWords[currentWordIndex];
                    const distractors = generateDistractors(word);
                    const allOptions = [word, ...distractors].sort(() => Math.random() - 0.5);
                    setMultipleChoiceOptions(allOptions);
                    timer = setTimeout(() => speakWord(word), 500);
                } else if (mode === 'listen' || mode === 'practice') {
                    timer = setTimeout(() => speakWord(shuffledWords[currentWordIndex]), 500);
                }

                // Focus input for listen/practice modes
                if ((mode === 'listen' || mode === 'practice') && inputRef.current) {
                    inputRef.current.focus();
                }

                return () => {
                    if (timer) clearTimeout(timer);
                };
            }, [currentWordIndex, mode, shuffledWords, feedback]);

            useEffect(() => {
                const handleKeyPress = (e) => {
                    if (mode === 'unscramble' && e.key === 'Enter') {
                        if (feedback) continueToNext();
                        else if (selectedLetters.length > 0) checkUnscramble();
                    }
                };
                window.addEventListener('keypress', handleKeyPress);
                return () => window.removeEventListener('keypress', handleKeyPress);
            }, [mode, selectedLetters, feedback]);

            const filterWordsByDifficulty = (words, difficulty) => {
                if (difficulty === 'all') return words;
                const categories = {
                    'very-easy': ['chair', 'brass', 'ready', 'scatter', 'gobble', 'eel', 'sizzle', 'Spanish', 'hornet', 'oval', 'plastic', 'mason', 'slander', 'evergreen', 'decompose', 'reasons', 'dismantle', 'glance', 'oath', 'sneakers', 'duets', 'cursive', 'pastel', 'hype', 'nestled', 'moderate', 'lantern', 'author', 'wily', 'veil', 'redress', 'cruiser', 'vitally', 'burrowed', 'pentagon', 'diagram', 'scrimmage', 'vulgar', 'resign', 'corrupt'],
                    'easy': ['padlock', 'hangdog', 'mustiness', 'shrouded', 'mouthpiece', 'potency', 'quartz', 'tournament', 'clementine', 'signature', 'influence', 'snorkeling', 'citadel', 'achievements', 'appliances', 'badminton', 'gardenia', 'absorption', 'Pacific', 'affiliation', 'synopsis', 'coriander', 'purgatory', 'torpor', 'covetous', 'oppression', 'abysmal', 'precipice', 'purview', 'suburbia', 'construe', 'fettle', 'curriculum', 'deuce', 'berth', 'cyst', 'knavery', 'synonym', 'purloined'],
                    'medium': ['marquee', 'traumatic', 'solemnly', 'ensemble', 'lye', 'lacrosse', 'cajolery', 'residuals', 'peroxide', 'apocalypse', 'barricade', 'anonymously', 'barrette', 'junket', 'Erie', 'silhouette', 'thesaurus', 'chandelier', 'concierge', 'hibiscus', 'maracas', 'burpees', 'piccolo', 'tulle', 'camphor', 'paparazzi', 'pogrom', 'sarsaparilla', 'cannelloni', 'bronchitis', 'diphtheria', 'corbels', 'Kilimanjaro', 'delectation', 'austerity', 'nascent', 'extremophile', 'monolithic', 'coven'],
                    'medium-hard': ['substantially', 'formidable', 'compunction', 'hyperventilated', 'onslaught', 'misanthrope', 'cravenly', 'hypocritical', 'contentious', 'agribusiness', 'invective', 'emphatically', 'prognosticate', 'satisfice', 'nuptials', 'aquacade', 'assuage', 'ballistics', 'efficacy', 'dreidel', 'alacrity', 'elision', 'sanctimonious', 'heptathlon', 'tempera', 'mitosis', 'apologia', 'mesomorph', 'claustrophobia', 'glissade', 'antebellum', 'weir', 'sortie', 'protÃ©gÃ©', 'maquisards', 'Charolais'],
                    'hard': ['pÃ¢tisserie', 'compaÃ±ero', 'pelota', 'eloge', 'mansard', 'ramate', 'paranephric', 'tontine', 'asyllabia', 'velodrome', 'dysplasia', 'Columbiad', 'terricolous', 'soporiferous', 'cyclopean', 'messianic', 'Austronesia', 'maxillary', 'Euclidean', 'archizoic', 'aphagia', 'persillade', 'capriccio', 'chitin', 'maisonette', 'maunaloa', 'hexastich', 'bathypelagic', 'syzygy', 'pharisaical', 'vicegerent', 'pince-nez', 'carotid', 'salaam', 'forzato'],
                    'very-hard': ['covey', 'apartheid', 'kibbutz', 'putti', 'beignet', 'fricassee', 'abecedarius', 'collunarium', 'scamillus', 'buccinator', 'Tijuana', 'silenus', 'marcottage', 'schuss', 'bodegon', 'cri de coeur', 'chaise longue', 'tathagata', 'phalanstery', 'diapir', 'harmattan', 'farinha', 'shamiana', 'chautauqua', 'heishi', 'mostaccioli', 'baetyl', 'gardai', 'gelinotte', 'zamacueca', 'gelÃ¤ndesprung', 'sittringee']
                };
                return words.filter(w => (categories[difficulty] || []).includes(w));
            };

            // Generate plausible wrong answers (distractors) for multiple choice
            const generateDistractors = (correctWord) => {
                const distractors = new Set();
                const word = correctWord.toLowerCase();

                // Strategy 1: Swap common vowels
                const vowelSwaps = { 'a': ['e', 'o'], 'e': ['a', 'i'], 'i': ['e', 'y'], 'o': ['a', 'u'], 'u': ['o', 'oo'] };
                for (let i = 0; i < word.length; i++) {
                    if (vowelSwaps[word[i]]) {
                        vowelSwaps[word[i]].forEach(swap => {
                            const distractor = word.slice(0, i) + swap + word.slice(i + 1);
                            if (distractor !== word) distractors.add(distractor);
                        });
                    }
                }

                // Strategy 2: Double or undouble consonants
                for (let i = 0; i < word.length - 1; i++) {
                    const char = word[i];
                    if (!/[aeiou]/.test(char)) {
                        // Double a consonant
                        if (word[i] !== word[i + 1]) {
                            const distractor = word.slice(0, i + 1) + char + word.slice(i + 1);
                            distractors.add(distractor);
                        }
                        // Undouble a consonant
                        if (word[i] === word[i + 1]) {
                            const distractor = word.slice(0, i) + word.slice(i + 1);
                            distractors.add(distractor);
                        }
                    }
                }

                // Strategy 3: Transpose adjacent letters
                for (let i = 0; i < word.length - 1; i++) {
                    const distractor = word.slice(0, i) + word[i + 1] + word[i] + word.slice(i + 2);
                    if (distractor !== word) distractors.add(distractor);
                }

                // Strategy 4: Common spelling confusions
                const confusions = [
                    ['ie', 'ei'], ['ei', 'ie'], ['ph', 'f'], ['f', 'ph'],
                    ['c', 'k'], ['k', 'c'], ['s', 'c'], ['c', 's'],
                    ['tion', 'sion'], ['sion', 'tion'], ['ence', 'ance'], ['ance', 'ence']
                ];
                confusions.forEach(([from, to]) => {
                    if (word.includes(from)) {
                        const distractor = word.replace(from, to);
                        if (distractor !== word) distractors.add(distractor);
                    }
                });

                // Strategy 5: Remove or add silent letters
                const silentPatterns = ['e$', 'ue$', 'gh', 'kn', 'wr'];
                silentPatterns.forEach(pattern => {
                    if (word.match(new RegExp(pattern))) {
                        const distractor = word.replace(new RegExp(pattern), '');
                        if (distractor !== word && distractor.length > 2) distractors.add(distractor);
                    }
                });

                // Convert back to original case
                const cased = Array.from(distractors).map(d => {
                    if (correctWord[0] === correctWord[0].toUpperCase()) {
                        return d.charAt(0).toUpperCase() + d.slice(1);
                    }
                    return d;
                });

                // Return 3 unique distractors
                return cased.slice(0, 3);
            };

            // Convert word to filename
            const getAudioFilename = (word) => {
                return word.toLowerCase()
                    .replace(/[Ã Ã¡Ã¢Ã£Ã¤Ã¥]/g, 'a')
                    .replace(/[Ã¨Ã©ÃªÃ«]/g, 'e')
                    .replace(/[Ã¬Ã­Ã®Ã¯]/g, 'i')
                    .replace(/[Ã²Ã³Ã´ÃµÃ¶]/g, 'o')
                    .replace(/[Ã¹ÃºÃ»Ã¼]/g, 'u')
                    .replace(/[Ã±]/g, 'n')
                    .replace(/[Ã§]/g, 'c')
                    .replace(/[Ã¤]/g, 'a')
                    .replace(/[Ã¶]/g, 'o')
                    .replace(/[Ã¼]/g, 'u')
                    .replace(/[ÃŸ]/g, 'ss')
                    .replace(/\s+/g, '_')
                    .replace(/[^a-z0-9_]/g, '');
            };

            const speakWord = async (word) => {
                try {
                    // Stop any currently playing audio
                    if (audioRef.current) {
                        audioRef.current.pause();
                        audioRef.current.currentTime = 0;
                    }

                    const filename = getAudioFilename(word);
                    const audioPath = `audio/${filename}.m4a`;

                    const audio = new Audio(audioPath);
                    audioRef.current = audio; // Store reference

                    return new Promise((resolve, reject) => {
                        audio.onended = () => {
                            audioRef.current = null;
                            inputRef.current?.focus();
                            resolve();
                        };
                        audio.onerror = (error) => {
                            audioRef.current = null;
                            console.error(`Failed to load audio: ${audioPath}`, error);
                            reject(error);
                        };
                        audio.play().catch(reject);
                    });
                } catch (error) {
                    audioRef.current = null;
                    console.error('Failed to play word:', error);
                }
            };

            const checkSpelling = () => {
                const correct = userInput.toLowerCase().trim() === shuffledWords[currentWordIndex].toLowerCase();
                setFeedback(correct ? 'correct' : 'incorrect');
                setWordsAttempted(wordsAttempted + 1);

                // Update userData
                const newUserData = { ...userData };
                newUserData.stats.totalWordsAttempted += 1;
                if (correct) {
                    newUserData.stats.totalCorrect += 1;
                    setScore(score + 1);
                    const newStreak = streak + 1;
                    setStreak(newStreak);
                    if (newStreak > newUserData.stats.bestStreak) {
                        newUserData.stats.bestStreak = newStreak;
                    }
                } else {
                    setStreak(0);
                }
                newUserData.wordHistory = updateWordHistory(newUserData, shuffledWords[currentWordIndex], correct);
                newUserData.stats.lastPlayed = new Date().toISOString();
                setUserData(newUserData);
                saveUserData(newUserData);
            };

            const checkUnscramble = () => {
                const userWord = selectedLetters.map(l => l.letter).join('');
                const correct = userWord.toLowerCase() === shuffledWords[currentWordIndex].toLowerCase();
                setFeedback(correct ? 'correct' : 'incorrect');
                setWordsAttempted(wordsAttempted + 1);

                // Update userData
                const newUserData = { ...userData };
                newUserData.stats.totalWordsAttempted += 1;
                if (correct) {
                    newUserData.stats.totalCorrect += 1;
                    setScore(score + 1);
                    const newStreak = streak + 1;
                    setStreak(newStreak);
                    if (newStreak > newUserData.stats.bestStreak) {
                        newUserData.stats.bestStreak = newStreak;
                    }
                } else {
                    setStreak(0);
                }
                newUserData.wordHistory = updateWordHistory(newUserData, shuffledWords[currentWordIndex], correct);
                newUserData.stats.lastPlayed = new Date().toISOString();
                setUserData(newUserData);
                saveUserData(newUserData);
            };

            const checkMultipleChoice = (selectedOption) => {
                const correct = selectedOption.toLowerCase() === shuffledWords[currentWordIndex].toLowerCase();
                setFeedback(correct ? 'correct' : 'incorrect');
                setWordsAttempted(wordsAttempted + 1);

                // Update userData
                const newUserData = { ...userData };
                newUserData.stats.totalWordsAttempted += 1;
                if (correct) {
                    newUserData.stats.totalCorrect += 1;
                    setScore(score + 1);
                    const newStreak = streak + 1;
                    setStreak(newStreak);
                    if (newStreak > newUserData.stats.bestStreak) {
                        newUserData.stats.bestStreak = newStreak;
                    }
                } else {
                    setStreak(0);
                }
                newUserData.wordHistory = updateWordHistory(newUserData, shuffledWords[currentWordIndex], correct);
                newUserData.stats.lastPlayed = new Date().toISOString();
                setUserData(newUserData);
                saveUserData(newUserData);
            };

            const continueToNext = () => {
                if (currentWordIndex < shuffledWords.length - 1) {
                    setCurrentWordIndex(currentWordIndex + 1);
                    setUserInput('');
                    setFeedback(null);
                    setSelectedLetters([]);
                    setTimeout(() => inputRef.current?.focus(), 100);
                } else {
                    setMode('results');
                }
            };

            const resetGame = () => {
                setScore(0);
                setStreak(0);
                setWordsAttempted(0);
                setCurrentWordIndex(0);
                setUserInput('');
                setFeedback(null);
                setSelectedLetters([]);
                const filtered = filterWordsByDifficulty(WORDS, difficultyFilter);
                setShuffledWords([...filtered].sort(() => Math.random() - 0.5));
            };

            const addLetter = (letterObj) => {
                setSelectedLetters([...selectedLetters, letterObj]);
                setScrambledLetters(scrambledLetters.filter(l => l.id !== letterObj.id));
            };

            const removeLetter = (letterObj) => {
                setSelectedLetters(selectedLetters.filter(l => l.id !== letterObj.id));
                setScrambledLetters([...scrambledLetters, letterObj]);
            };

            // HOME SCREEN
            if (mode === 'home') {
                const masteryStats = getMasteryStats(userData, WORDS);
                const missedWords = getMissedWords(userData, WORDS);

                const handleDifficultyChange = (difficulty) => {
                    setDifficultyFilter(difficulty);
                    const newUserData = { ...userData };
                    newUserData.settings.difficulty = difficulty;
                    setUserData(newUserData);
                    saveUserData(newUserData);
                };

                const startPracticeMistakes = () => {
                    const missed = getMissedWords(userData, WORDS);
                    if (missed.length > 0) {
                        setShuffledWords([...missed].sort(() => Math.random() - 0.5));
                        setCurrentWordIndex(0);
                        setMode('practice');
                    }
                };

                return React.createElement('div', { className: 'min-h-screen bg-gradient-to-br from-purple-400 via-pink-400 to-red-400 p-4 flex items-center justify-center' },
                    React.createElement('div', { className: 'bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full' },
                        React.createElement('div', { className: 'text-center mb-8' },
                            React.createElement('h1', { className: 'text-4xl font-bold text-purple-600 mb-2' }, 'Word Club'),
                            React.createElement('p', { className: 'text-gray-600' }, 'Master your spelling skills!')
                        ),
                        React.createElement('div', { className: 'mb-6' },
                            React.createElement('label', { className: 'block text-sm font-semibold text-gray-700 mb-2' }, 'Difficulty:'),
                            React.createElement('div', { className: 'grid grid-cols-2 gap-2' },
                                React.createElement('button', {
                                    onClick: () => handleDifficultyChange('all'),
                                    className: `px-4 py-2 rounded-lg font-medium ${difficultyFilter === 'all' ? 'bg-purple-500 text-white' : 'bg-gray-200'}`
                                }, 'All'),
                                ['very-easy', 'easy', 'medium', 'medium-hard', 'hard', 'very-hard'].map(level =>
                                    React.createElement('button', {
                                        key: level,
                                        onClick: () => handleDifficultyChange(level),
                                        className: `px-4 py-2 rounded-lg font-medium ${difficultyFilter === level ? 'bg-purple-500 text-white' : 'bg-gray-200'}`
                                    }, level.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' '))
                                )
                            )
                        ),
                        masteryStats.practiced > 0 && React.createElement('div', { className: 'mb-6 bg-gradient-to-r from-purple-50 to-pink-50 rounded-2xl p-4' },
                            React.createElement('h3', { className: 'text-sm font-bold text-purple-700 mb-3' }, 'ðŸ“Š Your Progress'),
                            React.createElement('div', { className: 'grid grid-cols-2 gap-3 text-center' },
                                React.createElement('div', { className: 'bg-white rounded-lg p-3' },
                                    React.createElement('div', { className: 'text-2xl font-bold text-green-600' }, masteryStats.mastered),
                                    React.createElement('div', { className: 'text-xs text-gray-600' }, 'Mastered')
                                ),
                                React.createElement('div', { className: 'bg-white rounded-lg p-3' },
                                    React.createElement('div', { className: 'text-2xl font-bold text-blue-600' }, masteryStats.practiced),
                                    React.createElement('div', { className: 'text-xs text-gray-600' }, 'Practiced')
                                ),
                                React.createElement('div', { className: 'bg-white rounded-lg p-3' },
                                    React.createElement('div', { className: 'text-2xl font-bold text-orange-600' }, masteryStats.needsPractice),
                                    React.createElement('div', { className: 'text-xs text-gray-600' }, 'Needs Practice')
                                ),
                                React.createElement('div', { className: 'bg-white rounded-lg p-3' },
                                    React.createElement('div', { className: 'text-2xl font-bold text-purple-600' }, userData.stats.bestStreak),
                                    React.createElement('div', { className: 'text-xs text-gray-600' }, 'Best Streak')
                                )
                            )
                        ),
                        React.createElement('div', { className: 'mb-6' },
                            React.createElement('div', { className: 'bg-green-50 border border-green-200 rounded-lg p-3 text-sm text-green-700' }, 'ðŸŽ™ï¸ High-Quality Pre-Recorded Audio (Allison Voice)')
                        ),
                        React.createElement('div', { className: 'space-y-4' },
                            React.createElement('button', { onClick: () => setMode('listen'), className: 'w-full bg-blue-500 text-white p-4 rounded-xl font-bold text-lg hover:scale-105 transition' }, 'Listen & Spell'),
                            React.createElement('button', { onClick: () => setMode('unscramble'), className: 'w-full bg-green-500 text-white p-4 rounded-xl font-bold text-lg hover:scale-105 transition' }, 'Unscramble'),
                            React.createElement('button', { onClick: () => setMode('multiple-choice'), className: 'w-full bg-yellow-500 text-white p-4 rounded-xl font-bold text-lg hover:scale-105 transition' }, 'Multiple Choice'),
                            React.createElement('button', { onClick: () => setMode('practice'), className: 'w-full bg-purple-500 text-white p-4 rounded-xl font-bold text-lg hover:scale-105 transition' }, 'Study Mode'),
                            missedWords.length > 0 && React.createElement('button', {
                                onClick: startPracticeMistakes,
                                className: 'w-full bg-gradient-to-r from-orange-500 to-red-500 text-white p-4 rounded-xl font-bold text-lg hover:scale-105 transition flex items-center justify-center gap-2'
                            },
                                React.createElement('span', null, 'âš ï¸'),
                                React.createElement('span', null, `Practice Mistakes (${missedWords.length})`)
                            )
                        )
                    )
                );
            }

            // RESULTS SCREEN
            if (mode === 'results') {
                const percentage = Math.round((score / wordsAttempted) * 100);
                return React.createElement('div', { className: 'min-h-screen bg-gradient-to-br from-purple-400 via-pink-400 to-red-400 p-4 flex items-center justify-center' },
                    React.createElement('div', { className: 'bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full text-center' },
                        React.createElement('h2', { className: 'text-3xl font-bold text-purple-600 mb-6' }, 'Great Job!'),
                        React.createElement('div', { className: 'bg-gradient-to-r from-purple-100 to-pink-100 rounded-2xl p-6 mb-6' },
                            React.createElement('div', { className: 'text-5xl font-bold text-purple-600 mb-2' }, `${score}/${wordsAttempted}`),
                            React.createElement('div', { className: 'text-3xl font-bold text-pink-600 mt-4' }, `${percentage}%`)
                        ),
                        React.createElement('button', { onClick: resetGame, className: 'w-full bg-green-500 text-white py-3 rounded-xl font-bold mb-3' }, 'Try Again'),
                        React.createElement('button', { onClick: () => { resetGame(); setMode('home'); }, className: 'w-full bg-gray-200 text-gray-700 py-3 rounded-xl font-bold' }, 'Back to Home')
                    )
                );
            }

            // LISTEN/PRACTICE MODES
            if (mode === 'listen' || mode === 'practice') {
                const currentWord = shuffledWords[currentWordIndex];
                return React.createElement('div', { className: 'min-h-screen bg-gradient-to-br from-blue-400 via-purple-400 to-pink-400 p-4' },
                    React.createElement('div', { className: 'max-w-2xl mx-auto bg-white rounded-3xl shadow-2xl p-8' },
                        React.createElement('div', { className: 'flex justify-between items-center mb-6' },
                            React.createElement('button', { onClick: () => { resetGame(); setMode('home'); } }, React.createElement(Home, { size: 24 })),
                            React.createElement('div', { className: 'flex gap-4 text-sm' },
                                React.createElement('div', { className: 'bg-purple-100 px-4 py-2 rounded-full font-bold' }, `Score: ${score}`),
                                React.createElement('div', { className: 'bg-pink-100 px-4 py-2 rounded-full font-bold' }, `Streak: ${streak} ðŸ”¥`)
                            )
                        ),
                        React.createElement('div', { className: 'text-center' },
                            React.createElement('div', { className: 'text-gray-500 mb-2' }, `Word ${currentWordIndex + 1} of ${shuffledWords.length}`),
                            React.createElement('div', { className: 'w-full bg-gray-200 rounded-full h-3 mb-6' },
                                React.createElement('div', { className: 'bg-gradient-to-r from-purple-500 to-pink-500 h-3 rounded-full transition-all', style: { width: `${((currentWordIndex + 1) / shuffledWords.length) * 100}%` } })
                            ),
                            mode === 'practice' ?
                                React.createElement('div', { className: 'bg-gradient-to-r from-purple-100 to-pink-100 rounded-2xl p-8 mb-6' },
                                    React.createElement('div', { className: 'text-4xl font-bold text-purple-600 mb-4' }, currentWord),
                                    React.createElement('button', { onClick: () => speakWord(currentWord), className: 'bg-blue-500 text-white px-6 py-3 rounded-full hover:bg-blue-600 inline-flex items-center gap-2' },
                                        React.createElement(Volume2, { size: 20 }), 'Hear Word'
                                    )
                                ) :
                                React.createElement('button', { onClick: () => speakWord(currentWord), className: 'bg-gradient-to-r from-blue-500 to-blue-600 text-white px-8 py-6 rounded-2xl hover:scale-105 transition shadow-lg inline-flex items-center gap-3 mb-6' },
                                    React.createElement(Volume2, { size: 32 }), React.createElement('span', { className: 'text-xl font-bold' }, 'Play Word')
                                ),
                            React.createElement('input', {
                                ref: inputRef,
                                type: 'text',
                                value: userInput,
                                onChange: (e) => setUserInput(e.target.value),
                                onKeyPress: (e) => { if (e.key === 'Enter') { feedback ? continueToNext() : checkSpelling(); } },
                                placeholder: 'Type the word...',
                                className: 'w-full text-2xl p-4 border-4 border-purple-300 rounded-xl text-center focus:border-purple-500 focus:outline-none mb-4',
                                disabled: feedback !== null,
                                autoFocus: true,
                                autoComplete: 'off',
                                autoCorrect: 'off',
                                autoCapitalize: 'off',
                                spellCheck: false
                            }),
                            feedback && React.createElement('div', { className: `mb-4 p-4 rounded-xl ${feedback === 'correct' ? 'bg-green-100 border-2 border-green-300' : 'bg-red-100 border-2 border-red-300'}` },
                                feedback === 'correct' ?
                                    React.createElement('div', null,
                                        React.createElement('div', { className: 'font-bold text-lg text-green-700 flex items-center gap-2 mb-2' },
                                            React.createElement(Check, { size: 24 }), 'Correct! Great job!'
                                        ),
                                        DEFINITIONS[currentWord] && React.createElement('div', { className: 'text-sm text-gray-700 mt-2 p-3 bg-white rounded-lg' },
                                            React.createElement('span', { className: 'font-semibold' }, 'Definition: '), DEFINITIONS[currentWord]
                                        )
                                    ) :
                                    React.createElement('div', null,
                                        React.createElement('div', { className: 'font-bold text-lg text-red-700 flex items-center gap-2 mb-2' },
                                            React.createElement(X, { size: 24 }), 'Incorrect'
                                        ),
                                        React.createElement('div', { className: 'text-sm text-red-800 space-y-1' },
                                            React.createElement('div', null, React.createElement('span', { className: 'font-semibold' }, 'You wrote: '), userInput || '(nothing)'),
                                            React.createElement('div', null, React.createElement('span', { className: 'font-semibold' }, 'Correct: '), currentWord)
                                        ),
                                        DEFINITIONS[currentWord] && React.createElement('div', { className: 'text-sm text-gray-700 mt-3 p-3 bg-white rounded-lg' },
                                            React.createElement('span', { className: 'font-semibold' }, 'Definition: '), DEFINITIONS[currentWord]
                                        )
                                    )
                            ),
                            !feedback ?
                                React.createElement('button', {
                                    onClick: checkSpelling,
                                    disabled: !userInput.trim(),
                                    className: 'w-full bg-green-500 text-white py-4 rounded-xl font-bold text-lg hover:scale-105 transition disabled:opacity-50'
                                }, 'Check Answer') :
                                React.createElement('button', {
                                    onClick: continueToNext,
                                    className: 'w-full bg-blue-500 text-white py-4 rounded-xl font-bold text-lg hover:scale-105 transition'
                                }, 'Continue')
                        )
                    )
                );
            }

            // UNSCRAMBLE MODE
            if (mode === 'unscramble') {
                const currentWord = shuffledWords[currentWordIndex];
                return React.createElement('div', { className: 'min-h-screen bg-gradient-to-br from-green-400 via-teal-400 to-blue-400 p-4' },
                    React.createElement('div', { className: 'max-w-2xl mx-auto bg-white rounded-3xl shadow-2xl p-8' },
                        React.createElement('div', { className: 'flex justify-between items-center mb-6' },
                            React.createElement('button', { onClick: () => { resetGame(); setMode('home'); } }, React.createElement(Home, { size: 24 })),
                            React.createElement('div', { className: 'flex gap-4 text-sm' },
                                React.createElement('div', { className: 'bg-green-100 px-4 py-2 rounded-full font-bold' }, `Score: ${score}`),
                                React.createElement('div', { className: 'bg-teal-100 px-4 py-2 rounded-full font-bold' }, `Streak: ${streak} ðŸ”¥`)
                            )
                        ),
                        React.createElement('div', { className: 'text-center' },
                            React.createElement('div', { className: 'text-gray-500 mb-2' }, `Word ${currentWordIndex + 1} of ${shuffledWords.length}`),
                            React.createElement('div', { className: 'w-full bg-gray-200 rounded-full h-3 mb-6' },
                                React.createElement('div', { className: 'bg-gradient-to-r from-green-500 to-teal-500 h-3 rounded-full transition-all', style: { width: `${((currentWordIndex + 1) / shuffledWords.length) * 100}%` } })
                            ),
                            React.createElement('button', { onClick: () => speakWord(currentWord), className: 'bg-blue-500 text-white px-6 py-3 rounded-full hover:scale-105 transition shadow-lg inline-flex items-center gap-2 mb-6' },
                                React.createElement(Volume2, { size: 20 }), 'Hear Word'
                            ),
                            React.createElement('div', { className: 'bg-gradient-to-r from-green-100 to-teal-100 rounded-2xl p-6 mb-6 min-h-20 flex items-center justify-center flex-wrap gap-2' },
                                selectedLetters.length === 0 ?
                                    React.createElement('div', { className: 'text-gray-400 text-lg' }, 'Tap letters to spell') :
                                    selectedLetters.map((letterObj) =>
                                        React.createElement('button', {
                                            key: letterObj.id,
                                            onClick: () => removeLetter(letterObj),
                                            className: 'bg-white text-2xl font-bold px-4 py-3 rounded-lg shadow-md hover:bg-gray-100 min-w-12',
                                            disabled: feedback !== null
                                        }, letterObj.letter)
                                    )
                            ),
                            React.createElement('div', { className: 'flex flex-wrap gap-2 justify-center mb-6' },
                                scrambledLetters.map((letterObj) =>
                                    React.createElement('button', {
                                        key: letterObj.id,
                                        onClick: () => addLetter(letterObj),
                                        className: 'bg-gradient-to-br from-green-400 to-teal-400 text-white text-2xl font-bold px-4 py-3 rounded-lg shadow-lg hover:scale-110 transition min-w-12',
                                        disabled: feedback !== null
                                    }, letterObj.letter)
                                )
                            ),
                            feedback && React.createElement('div', { className: `mb-4 p-4 rounded-xl ${feedback === 'correct' ? 'bg-green-100 border-2 border-green-300' : 'bg-red-100 border-2 border-red-300'}` },
                                feedback === 'correct' ?
                                    React.createElement('div', null,
                                        React.createElement('div', { className: 'font-bold text-lg text-green-700 flex items-center gap-2 mb-2' },
                                            React.createElement(Check, { size: 24 }), 'Correct!'
                                        ),
                                        DEFINITIONS[currentWord] && React.createElement('div', { className: 'text-sm text-gray-700 mt-2 p-3 bg-white rounded-lg' },
                                            React.createElement('span', { className: 'font-semibold' }, 'Definition: '), DEFINITIONS[currentWord]
                                        )
                                    ) :
                                    React.createElement('div', null,
                                        React.createElement('div', { className: 'font-bold text-lg text-red-700 flex items-center gap-2 mb-2' },
                                            React.createElement(X, { size: 24 }), 'Incorrect'
                                        ),
                                        React.createElement('div', { className: 'text-sm text-red-800 space-y-1' },
                                            React.createElement('div', null, React.createElement('span', { className: 'font-semibold' }, 'You spelled: '), selectedLetters.map(l => l.letter).join('') || '(nothing)'),
                                            React.createElement('div', null, React.createElement('span', { className: 'font-semibold' }, 'Correct: '), currentWord)
                                        ),
                                        DEFINITIONS[currentWord] && React.createElement('div', { className: 'text-sm text-gray-700 mt-3 p-3 bg-white rounded-lg' },
                                            React.createElement('span', { className: 'font-semibold' }, 'Definition: '), DEFINITIONS[currentWord]
                                        )
                                    )
                            ),
                            !feedback ?
                                React.createElement('button', {
                                    onClick: checkUnscramble,
                                    disabled: selectedLetters.length === 0,
                                    className: 'w-full bg-green-500 text-white py-4 rounded-xl font-bold text-lg hover:scale-105 transition disabled:opacity-50'
                                }, 'Check Answer') :
                                React.createElement('button', {
                                    onClick: continueToNext,
                                    className: 'w-full bg-blue-500 text-white py-4 rounded-xl font-bold text-lg hover:scale-105 transition'
                                }, 'Continue')
                        )
                    )
                );
            }

            // MULTIPLE CHOICE MODE
            if (mode === 'multiple-choice') {
                const currentWord = shuffledWords[currentWordIndex];
                return React.createElement('div', { className: 'min-h-screen bg-gradient-to-br from-yellow-400 via-orange-400 to-red-400 p-4' },
                    React.createElement('div', { className: 'max-w-2xl mx-auto bg-white rounded-3xl shadow-2xl p-8' },
                        React.createElement('div', { className: 'flex justify-between items-center mb-6' },
                            React.createElement('button', { onClick: () => { resetGame(); setMode('home'); } }, React.createElement(Home, { size: 24 })),
                            React.createElement('div', { className: 'flex gap-4 text-sm' },
                                React.createElement('div', { className: 'bg-yellow-100 px-4 py-2 rounded-full font-bold' }, `Score: ${score}`),
                                React.createElement('div', { className: 'bg-orange-100 px-4 py-2 rounded-full font-bold' }, `Streak: ${streak} ðŸ”¥`)
                            )
                        ),
                        React.createElement('div', { className: 'text-center' },
                            React.createElement('div', { className: 'text-gray-500 mb-2' }, `Word ${currentWordIndex + 1} of ${shuffledWords.length}`),
                            React.createElement('div', { className: 'w-full bg-gray-200 rounded-full h-3 mb-6' },
                                React.createElement('div', { className: 'bg-gradient-to-r from-yellow-500 to-orange-500 h-3 rounded-full transition-all', style: { width: `${((currentWordIndex + 1) / shuffledWords.length) * 100}%` } })
                            ),
                            React.createElement('div', { className: 'mb-6' },
                                React.createElement('button', { onClick: () => speakWord(currentWord), className: 'bg-blue-500 text-white px-8 py-4 rounded-full hover:scale-105 transition shadow-lg inline-flex items-center gap-3' },
                                    React.createElement(Volume2, { size: 24 }), React.createElement('span', { className: 'text-xl font-bold' }, 'Play Word')
                                )
                            ),
                            React.createElement('div', { className: 'text-lg text-gray-600 mb-6' }, 'Choose the correct spelling:'),
                            React.createElement('div', { className: 'grid grid-cols-1 gap-3 mb-6' },
                                multipleChoiceOptions.map((option, index) =>
                                    React.createElement('button', {
                                        key: index,
                                        onClick: () => !feedback && checkMultipleChoice(option),
                                        disabled: feedback !== null,
                                        className: `p-4 rounded-xl font-bold text-lg transition ${
                                            feedback && option.toLowerCase() === currentWord.toLowerCase()
                                                ? 'bg-green-500 text-white border-4 border-green-600'
                                                : feedback
                                                    ? 'bg-gray-200 text-gray-400'
                                                    : 'bg-gradient-to-r from-yellow-100 to-orange-100 hover:from-yellow-200 hover:to-orange-200 border-2 border-yellow-300 hover:scale-105'
                                        }`
                                    }, option)
                                )
                            ),
                            feedback && React.createElement('div', { className: `mb-4 p-4 rounded-xl ${feedback === 'correct' ? 'bg-green-100 border-2 border-green-300' : 'bg-red-100 border-2 border-red-300'}` },
                                feedback === 'correct' ?
                                    React.createElement('div', null,
                                        React.createElement('div', { className: 'font-bold text-lg text-green-700 flex items-center gap-2 mb-2' },
                                            React.createElement(Check, { size: 24 }), 'Correct!'
                                        ),
                                        DEFINITIONS[currentWord] && React.createElement('div', { className: 'text-sm text-gray-700 mt-2 p-3 bg-white rounded-lg' },
                                            React.createElement('span', { className: 'font-semibold' }, 'Definition: '), DEFINITIONS[currentWord]
                                        )
                                    ) :
                                    React.createElement('div', null,
                                        React.createElement('div', { className: 'font-bold text-lg text-red-700 flex items-center gap-2 mb-2' },
                                            React.createElement(X, { size: 24 }), 'Incorrect'
                                        ),
                                        React.createElement('div', { className: 'text-sm text-red-800 mb-2' },
                                            React.createElement('span', { className: 'font-semibold' }, 'Correct answer: '), currentWord
                                        ),
                                        DEFINITIONS[currentWord] && React.createElement('div', { className: 'text-sm text-gray-700 mt-3 p-3 bg-white rounded-lg' },
                                            React.createElement('span', { className: 'font-semibold' }, 'Definition: '), DEFINITIONS[currentWord]
                                        )
                                    )
                            ),
                            feedback && React.createElement('button', {
                                onClick: continueToNext,
                                className: 'w-full bg-blue-500 text-white py-4 rounded-xl font-bold text-lg hover:scale-105 transition'
                            }, 'Continue')
                        )
                    )
                );
            }

            return null;
        }

        ReactDOM.render(React.createElement(SpellingApp), document.getElementById('root'));
    </script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then((registration) => {
                        console.log('âœ“ Service Worker registered:', registration.scope);

                        // Check for updates periodically
                        setInterval(() => {
                            registration.update();
                        }, 60000); // Check every minute
                    })
                    .catch((error) => {
                        console.error('âœ— Service Worker registration failed:', error);
                    });
            });
        } else {
            console.log('Service Worker not supported in this browser');
        }
    </script>
</body>
</html>